#!/usr/bin/env sh
# shellcheck disable=SC2086

# `cargo-docserve`: Live refreshing Rust documentation.
# Source: https://benjamincongdon.me/blog/2018/08/22/Live-Refreshing-Cargo-Docs/

if ! type cargo-watch >/dev/null; then
  echo "! \`cargo-watch\` is not installed!"
  echo "! Run \`cargo install cargo-watch\` to install."
  exit 1
fi

if ! type browser-sync >/dev/null; then
  echo "! \`browser-sync\` is not installed!"
  echo "! Run \`npm install -g browser-sync\` to install."
  exit 1
fi

browser-sync start --server target/doc --serveStatic target/doc --files target/doc --directory ${BROWSER_SYNC_ARGS} &
cargo-watch ${CARGO_WATCH_ARGS} -s "cargo doc ${CARGO_DOC_ARGS}"
